---
title: "b201a final code"
author: "Lillian Chen"
date: "12/5/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(kableExtra)
library(ggpubr)
library(ggplot2)
```


```{r}
u <- seq(0.04, 1, 0.04)
x <- cos(pi*u)
e <- dnorm(x, mean = 0, sd = 0.01)
y <- sin(pi*u) + e

data <- data.frame(u=u, x = x, x2 = x^2, y = y)

ggscatter(data = data, x = "x", y = "y", add = "reg.line", cor.coef = T)
ggscatter(data = data, x = "x2", y = "y", add = "reg.line", cor.coef = T)

plot(x,y)
points(x^2,y, col="blue")

lm(y~x, data = data)
lm(y~x+x2, data=data)

```

```{r}
options(knitr.kable.NA = '')
k <- 3 
N <- 12
df_b <- k-1
df_w <- N-k
df_tot <- N-1
grandmean <- (4*28.60 + 4*31.38 + 4*19.08)/N
mean11 <- 28.60
mean12 <- 31.38
mean13 <- 19.08
ssb <- 4*(28.60-grandmean)^2 + 4*(31.38-grandmean)^2 + 4*(19.08-grandmean)^2
ssw <- 3*(3.22)^2 + 3*(3.17)^2 + 3*(1.81)^2
msb <- ssb/df_b
msw <- ssw/df_w
Fstat <- msb/msw
p <- 1 - pf(Fstat, k-1, N-k)

q7a <- data.frame(Source = c("Between groups (Treatment)", 
                             "Within groups (Error)", 
                             "Total"),
                  df = c(k-1, N-k, N-1),
                  SS = c(ssb, ssw, ssb+ssw),
                  MS = c(msb, msw, (ssb+ssw)/(N-1)),
                  F = c(Fstat, NA, NA),
                  p = c(p, NA, NA))

kbl(q7a, booktabs = T, 
    caption = "ANOVA Table 2A") %>% 
  kable_styling(latex_options = c("hold_position"))

abdata <- data.frame(speed = c("penicillin", "tetracycline", "erythromycin"),
                       n = c(4,4,4),
                       means = c(28.60,31.38,19.08),
                       sd = c(3.22,3.17,1.81))

#using anovaMean function from package HH for one-way ANOVA with summary statistics
HH::anovaMean(abdata$speed, abdata$n, abdata$means, abdata$sd, ylabel=c("antibiotic"))
```

